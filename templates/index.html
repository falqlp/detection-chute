<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Chute Messages</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var socket = io();

            socket.on('connect', function() {
                console.log('Connected to server');
            });

            socket.on('last_messages', function(messages) {
                var messageList = document.getElementById('messageList');
                messageList.innerHTML = ''; // Clear the list
                messages.forEach(function(msg) {
                    var listItem = document.createElement('li');
                    listItem.textContent = `Date: ${msg.date}, Card ID: ${msg.card_id}`;
                    messageList.appendChild(listItem);
                });
            });

            socket.on('new_message', function(data) {
                console.log('New message received:', data.message);
                // No need to update the message list here since 'last_messages' will handle it
            });
        });
    </script>
</head>
<body>
    <h1>Chute Messages</h1>
    <ul id="messageList"></ul>
</body>
</html>
